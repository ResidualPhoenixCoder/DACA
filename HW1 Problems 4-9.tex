\documentclass[fleqn]{article}
\usepackage{amsmath,amsfonts}
\usepackage{algorithm,algpseudocode}
\usepackage[margin=0.24in]{geometry}
\usepackage{enumitem}
\usepackage{tikz}
\setdescription{leftmargin=\parindent,labelindent=\parindent}
\title{Homework 1 - Problems 7, 8, 9}
\author{Mark Labrador}
\date{\today}

\begin{document}
\maketitle
\paragraph{Problem 4a - Multiplicative Inverses} ~\\
\begin{align*}
2^{902} \equiv\ 2^{6\cdot150 + 2} \equiv\ 2^{2}2^{6\cdot150} \equiv\ 2^{2}(2^{6})^{150} \equiv\ 2^{2}(1)^{150} \equiv\ 2^2 \equiv\ 4\ \textrm{mod}\ 7\text{, by Fermat's Little Theorem.}
\end{align*}

\paragraph{Problem 4b - Multiplicative Inverses} ~\\
\begin{itemize}
	\item $11y \equiv\ 1\ \textrm{mod}\ 120$, $y=11$
	\item $13y \equiv\ 1\ \textrm{mod}\ 45$, $y=7$
	\item $35y \equiv\ 1\ \textrm{mod}\ 77$, $y$, does not exist because 35 and 77 are not relatively prime.
	\item $9y \equiv\ 1\ \textrm{mod}\ 11$, $y=5$
	\item $11 \equiv\ 1\ \textrm{mod}\ 1111$, $y$ does not exist because 11 and 1111 are not relatively prime.
\end{itemize}

\paragraph{Problem 4c - NO ANSWER}

\paragraph{Problem 5a - Greatest Common Divisor}
True.
\begin{align*}
\gcd{(x,y)} &= \gcd{(x, x+y)}\\
&= \gcd{(x+y, x+x+y)}\\
&= \gcd{(2x+y+x+y, 2x+y)}\\
&= \gcd{(3x+2y,2x+y+3x+2y)}\\
&= \gcd{(3x+2y,5x+3y)}
\end{align*}

\paragraph{Problem 5b - Greatest Common Divisor}
This will be proved using the property that $\gcd(a,b) = \gcd(b, a mod b)$.\\

Assume that $1 \le i,j \le n$, $i \neq j$, and $i < j$.  Observe the following: \\
\begin{align*}
s_j\ \equiv\ 1 \textrm{mod}\ s_i
\end{align*}

This is because $s_j= 1 + \prod\limits_{l=0}^{j-1} s_l$, which means $s_i$ is contained in the term $\prod\limits_{l=0}^{j-1} s_l$.  So applying the mod operator with $s_i$ will cause this term to disappear, and leave $1$ as the remaining term.  This implies, $\gcd(s_j,s_i)=\gcd(s_i, s_j\ \text{mod}\ s_i)=\gcd(s_i, 1)=1$.  Therefore, all $s_k$ are relatively prime.

\pagebreak
\paragraph{Problem 6a - Universal Hashing}
Suppose $h \in H$, where $H$ is the family of hashing functions, and $m \in M$, where $M$ is the set of all 8 x 32 binary matrices.  If a 32-bit integer is selected and converted to a 32 x 1 matrix called, $y$, then the following operation is performed,

\begin{align*}
h(y) &= m \cdot y\ \textrm{mod}\ 2
\end{align*}

\noindent
Let $s_i=\sum\limits_{j=0}^{31} m_{i,j}y_{j}\ \textrm{mod}\ 2$, where $m_{i,j}$ is the entry of the i\textsuperscript{th} row and j\textsuperscript{th} column of the matrix $M$ and $y_{j}$ is the j\textsuperscript{th} row of the $y$ matrix.\\

\noindent
After $h(m, y)$ is performed, the resulting 8-bit vector call, $H$ has the entries $s_i$ for $i = 0, \ldots, 7$.  To determine the probability of hashing to any one slot of the 256 possible slots, the probability of hashing to any one 8-bit number is what needs to be determined, bit-by-bit.\\

\noindent
Suppose two distinct integers are chosen, $y_1$ and $y_2$ such that their last bit differs.  So to compute the probability of picking a row like this, the following relationship is established.\\

\noindent
Let E be the event where the last bit of each of column of $m$ is chosen such that the relationship below holds.
\begin{align*}
\sum\limits_{j=0}^{30} m_{i,j}\left(y_{2j} - y_{1j}\right)\ &\equiv\ m_{i,31}(y_{2(31)} - y_{1(31)})\ \textrm{mod}\ 2\\
Pr\{h(m, y_1) = h(m, y_2)\} &= Pr\{\textrm{E\}}
\end{align*}

\noindent
Since 2 is prime and $y_{2j} \neq y_{1j}$, there is an unique inverse for $y_{2(31)} - y_{1(31)}$ that is either 0 or 1.  So $Pr\{E\}= \frac{1}{2}$.\\

\noindent
This occurs for every row of the matrix H.  So the probability of getting an 8-bit matrix H is the product of its parts.  This means, $Pr\{$Hashing to 1 out of 256 slots$\}=Pr\{E\}=(\frac{1}{2})^{8}=\frac{1}{256}$.  Therefore, the family of functions, $H$ is universal.

\paragraph{Problem 6b - Random Bits}
This family required 256 random bits.

\pagebreak
\paragraph{Problem 7a} ~\\
Finding the integers that are their own inverses is the same as asking, $x^2 \equiv\ 1\ \textrm{mod}\ n$.  This gives the following,

\begin{align*}
x^2 &\equiv\ 1\ \textrm{mod}\ n\\
x^2 - 1 &\equiv\ 0\ \textrm{mod}\ n\\
(x+1)(x-1) &\equiv\ 0\ \textrm{mod}\ n\\
x+1 &\equiv\ 0\ \textrm{mod}\ n \rightarrow x \equiv\ -1\ \equiv\ n-1\ \textrm{mod}\ n\\
x-1 &\equiv\ 0\ \textrm{mod}\ n \rightarrow x \equiv\ 1\ \textrm{mod}\ n
\end{align*}

So the integers that are their own inverses are $n-1$ and $1$ modulo $n$ for $x$ in the range of $0$ to $n-1$.
\paragraph{Problem 7b} ~\\
For $p=2$, $(p-1)! \equiv\ (2-1)\ \equiv\ 1\ \equiv\ -1 \textrm{mod}\ 2$.\\\\
Suppose $p > 2$ and $p$ is prime.  Then $b \in B = \{0, 1, 2, \ldots, p-1\}$ has a multiplicative inverse modulo $p$ because $(\forall\ b \in B)\,(\gcd{(b, p)} = 1)$, which will be called $b^{-1}$.  These inverses lie in the set $B$.  So there will be $\frac{p-3}{2}$ pairs of inverses because $p-1$ and $1$ are their own inverses from part a of this problem.  This implies the following,
\begin{align*}
	(p-2)! &\equiv\ 1\ \textrm{mod}\ p\\
	(p-1)(p-2)! &\equiv\ p-1\ \textrm{mod}\ p\\
	(p-1)! &\equiv\ -1\ \textrm{mod}\ p
\end{align*}

\paragraph{Problem 7c} ~\\
Suppose $n$ is a composite number.  So there are integers $a$ and $b$ such that $n=ab$.  This implies that $a < n$ and $b < n$, which means $a$ and $b$ will be in the product $(n-1)!$.  So $(n-1)! \equiv\ 0\ \textrm{mod} n$, and not $-1\ \textrm{mod}\ n$.

\paragraph{Problem 7d} ~\\
This primality test requires $n-2$ multiplications to compute $(n-1)!$.  This requires, $O(n(log_{2}n)^{2})$ bit operations.
 
\pagebreak
\paragraph{Problem 8a - Chinese Remainder Theorem} ~\\
\begin{table}[ht]
	\begin{tabular}{c c c}
	\hline\hline
	Number & modulo 5 & modulo 7\\ [0.5ex]
	\hline
	0 & 0 & 0 \\
	1 & 1 & 1 \\
	2 & 2 & 2 \\
	3 & 3 & 3 \\
	4 & 4 & 4 \\
	5 & 0 & 5 \\
	6 & 1 & 6 \\
	7 & 2 & 0 \\
	8 & 3 & 1 \\
	9 & 4 & 2 \\
	10 & 0 & 3 \\
	11 & 1 & 4 \\
	12 & 2 & 5 \\
	13 & 3 & 6 \\
	14 & 4 & 0 \\
	15 & 0 & 1 \\
	16 & 1 & 2 \\
	17 & 2 & 3 \\
	18 & 3 & 4 \\
	19 & 4 & 5 \\
	20 & 0 & 6 \\
	21 & 1 & 0 \\
	22 & 2 & 1 \\
	23 & 3 & 2 \\
	24 & 4 & 3 \\
	25 & 0 & 4 \\
	26 & 1 & 5 \\
	27 & 2 & 6 \\
	28 & 3 & 0 \\
	29 & 4 & 1 \\
	30 & 0 & 2 \\
	31 & 1 & 3 \\
	32 & 2 & 4 \\
	33 & 3 & 5 \\
	34 & 4 & 6 \\
	35 & 0 & 0 \\
	36 & 1 & 1
	\end{tabular}
\end{table}

\pagebreak
\paragraph{Problem 8b - Chinese Remainder Theorem} ~\\
Suppose $x$ and $y$ are two different prime numbers, and for every pair of integers $m$ and $n$, $0 \le m < x$ and $0 \le n < y$. \\\\
\noindent
Let A = $\{0, 1, \dots, xy - 1\}$. This is the range of $xy$.\\

\noindent
Since $0 \le m < x$ and $0 \le n < y$, it is known that $0 \le my < xy$ and $0 \le nx < xy$, which implies the following, $my \in A$ and $nx \in A$.  If $q$ is selected to be the following: 

\begin{equation*}
q = myy^{-1} + nxx^{-1} \text{, where $y^{-1}$ and $x^{-1}$ are inverses of $y$ mod $x$ and $x$ mod $y$, respectively.}
\end{equation*}
The inverses of $x$ and $y$ are defined because they are two different primes, making them relatively prime.  Then $q\ (\textrm{mod}\ xy) \in A$ by definition of the modulus operator, which allows the following, $0 \le q < 2xy \rightarrow 0 \le q\ (\textrm{mod}\ xy) < xy$. \\

\noindent
The next step is to show the following:
\begin{align*}
q &\equiv\ m (\textrm{mod}\ x) \\
q &\equiv\ n (\textrm{mod}\ y)
\end{align*}

\noindent
Using the selection of $q$ as the starting point, the integers $m$ and $n$ will be derived, mod $x$ and mod $y$, respectively.

\begin{align*}
q\ \textrm{mod}\ x &\equiv\ myy^{-1} + nxx^{-1} \equiv\ m mod x \text{, because $yy^{-1}$ is $1$ mod $x$ since they're inverses of each other, and $nxx^{-1}$ disappears.}\\
q\ \textrm{mod}\ y &\equiv\ myy^{-1} + nxx^{-1} \equiv\ n mod y \text {, because $xx^{-1}$ is $1$ mod $y$ since they're inverses of each other, and $myy^{-1}$ disappears.}
\end{align*}

\noindent
Now to prove the uniqueness of $q$.  Suppose there are two choices that satisfy the system above, $q_1, q_2 \in A$.  Then the following is true,

\begin{align*}
q_1 &\equiv\ m\ \textrm{mod}\ x\\
q_1 &\equiv\ n\ \textrm{mod}\ y\\
q_2 &\equiv\ m\ \textrm{mod}\ x\\
q_2 &\equiv\ n\ \textrm{mod}\ y\\
\\
q_1 - q_2 &\equiv\ 0\ \textrm{mod}\ x \rightarrow x\ |\ q_1-q_2\\
q_1 - q_2 &\equiv\ 0\ \textrm{mod}\ y \rightarrow y\ |\ q_1-q_2\\
\text{So $xy\ |\ q_1-q_2$}&\text{, which means $q_1 \equiv\ q_2$ mod $xy \rightarrow q_1=q_2$ because $q_1, q_2 \in A$.}
\end{align*}
\noindent
Therefore, $q$ is unique.

\paragraph{Problem 8c - Chinese Remainder Theorem} ~\\
Suppose $x$ and $y$ are different prime numbers such that,
\begin{align*}
q &\equiv\ m\ \textrm{mod}\ x\\
q &\equiv\ n\ \textrm{mod}\ y
\end{align*}

\noindent
Let $M_x=y$, $M_y=x$
\begin{align*}
&a_x \text{, be the inverse of $M_x$ mod $x$.}\\
&a_y \text{, be the inverse of $M_y$ mod $y$.}
\end{align*}
\noindent
So the follow equation for $q$ is derived,
\begin{equation*}
q = mM_xa_x + nM_ya_y\ \textrm{mod}\ xy
\end{equation*}
When $q$ is mod-ed with $x$, the second term $nM_ya_y$ disappears because $M_y=x$, and the part of the first term, $M_xa_x \equiv 1\ \textrm{mod}\ x$ because they are inverses of each other mod $x$. So $q \equiv\ m\ \textrm{mod}\ x$.\\

\noindent
When $q$ is mod-ed with $y$, the first term $mM_xa_x$ disappears because $M_x=y$, and the part of the second term, $M_ya_y \equiv 1\ \textrm{mod}\ y$ because they are inverses of each other mod $y$.  So $q \equiv\ n\ \textrm{mod}\ y$.\\

\paragraph{Problem 8d - Chinese Remainder Theorem} ~\\
In the case of three primes, $x$, $y$, and $z$, the property still holds.  When it is three primes the equation for $q$ changes to the following:
\begin{equation*}
q \equiv\ a_xM_xI_x + a_yM_yI_z + a_zM_zI_z\ \textrm{mod}\ M
\end{equation*}
where the parts of the equation are defined as followed:
Let $M=xyz$.
\begin{align*}
&a_x, a_y, a_z \text{, be the residues when mod-ed $x$, $y$, and $z$, respectively.}\\
&M_x=\frac{M}{x}=yz, M_y=\frac{M}{y}=xz, M_z=\frac{M}{z}=xy\\
&I_x, I_y, I_z \text{, be the inverses of $M_x$ mod $x$, $M_y$ mod $y$, and $M_z$ mod $z$, respectively.}
\end{align*}
\paragraph{Problem 9 - RSA Cryptography} ~\\
\begin{align*}
	\text{Let } &N_{b}, N_{c}, N_{d} \text{ be Bob, Charlie, and David's public key, respectively.}\\	
	&M=N_{b}N_{c}N_{d}\text{, }M_{b}=\frac{M}{N_{b}}\text{, }M_{c}=\frac{M}{N_{c}}\text{, }M_{d}=\frac{M}{N_{d}}\\
	&e\text{, be the encryption key for Bob, Charlie, and David.}\\
	&m_{a} \text{, be the message sent by Alice.}
\end{align*}

With the given information, the Chinese Remainder Theorem is applicable to find $m_{a}$:
\begin{align*}
e &= 3\\
M &=674 \cdot 36 \cdot 948 = 23002272\\
M_{b}&= 34128 \text{, } M_{c} = 638952 \text{, } M_{d}=24264\\
(m_{a})^{e} \equiv\ (m_{a})^{3}\ &\equiv\ 674\ \textrm{mod}\ N_{b}\ \equiv\ 674\ \textrm{mod}\ 3337\\
&\equiv\ 36\ \textrm{mod}\ N_{c}\ \equiv\ 36\ \textrm{mod}\ 187\\
&\equiv\ 948\ \textrm{mod}\ N_{d}\ \equiv\ 948\ \textrm{mod}\ 1219
\end{align*}
From the theorem, the equation we are looking for is:
\begin{equation}
(m_{a})^{3}\ \equiv\ (674)M_{b}y_{b} + (36)M_{c}y_{c} + (948)M_{d}y_{d}\ (mod M)
\end{equation}
The next step is to determine the inverses, $y_{b}$, $y_{c}$, and $y_{d}$.
\begin{itemize}
\item $M_{b}y_{b}\ \textrm{mod}\ N_{b}$, $y_{b}=2593$.
\item $M_{c}y_{c}\ \textrm{mod}\ N_{c}$, $y_{c}=90$.
\item $M_{d}y_{d}\ \textrm{mod}\ N_{d}$, $y_{d}=620$.
\end{itemize}
Going back to equation (1), insert the terms determined here:
\begin{align*}
(m_a)^{e} &\equiv\ (674)M_{b}y_{b} + (36)M_{c}y_{c} + (948)M_{d}y_{d}\ \textrm{(mod}\ M\textrm{)}\\
(m_a)^{3} &\equiv\ (674)(34128)(2593) + (36)(638952)(90) + (948)(24264)(620)\ \textrm{(mod}\ 23002272\textrm{)}\\
&\equiv\ 75976504416\ \textrm{(mod}\ 23002272 \textrm{)}\\
&\equiv\ 0\ \textrm{(mod}\ 23002272 \textrm{)}\\
m_a &\equiv\ 0\ \textrm{(mod}\ 23002272 \textrm{)}
\end{align*}

Therefore, the original message was $m_a = 0$.
\end{document}